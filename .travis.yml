language: ruby
sudo: false
cache:
  bundler: true
  directories:
    - node_modules
rvm:
  - "2.5.1"
services:
  - postgresql
addons:
  postgresql: "9.6"
env:
  - RAILS_ENV=test NODE_ENV=test SECRET_KEY_BASE=0af8c0e49e9259f2d777cfcd121d8540cee914c34b0abf08dd825bdee47c402daf9f2b9b74a9fff6f88ed95257ae39504e0d59c66400413b0cf7d29079c6358b
before_install:
  - gem install bundler -v '1.17.3'
  - . $HOME/.nvm/nvm.sh
  - nvm install 10.0.0
  - nvm use 10.0.0
  - curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.12.0
  - export PATH="$HOME/.yarn/bin:$PATH"
script:
  - "ruby --version && [ \"$(ruby --version | cut -c1-11)\" == 'ruby 2.5.1p' ]"
  - "bundle --version && [ \"$(bundle --version)\" == 'Bundler version 1.17.3' ]"
  - "node --version && [ \"$(node --version)\" == 'v10.0.0' ]"
  - "yarn --version && [ \"$(yarn --version)\" == '1.12.0' ]"
  - yarn install
  - bundle exec rails db:create
  - bundle exec rails db:schema:load
  - bundle exec rails spec:fixture_builder:rebuild
  - bundle exec rails spec:rb
  - bundle exec rails spec:js
notifications:
  email:
    on_success: never
    on_failure: always
deploy:
  provider: heroku
  # This token will expire 2019-12-27.
  # To make a new one, see: https://docs.travis-ci.com/user/deployment/heroku/
  api_key:
    secure: CdfeglfvoXnagqKGJhwiyYXpiu+BZWmvg4C1vYI0zn9wBeXCiUC9BmhKJXznYsvw+KFYcwpTDIfaDlAppXJG8i+vk+DWJ+Kyw+uwJ8hMC+L3bNMywa2887qBXghIg7PFR+tc2Fd9Kerbhl5qjlQ3edLfpwYviHY5/86mFT938mMIszj7b6P0DfCDYvK5WhIx2UdlC5ihGD2ymNFxOY7k6/06tJIh9gJzFs3XkQkn0T7OW3xMXAlz8xJpw6q6Q0ECTzshrQHZfCiiMcuZFiD2hGaqRr+Y3YIrIgIjz76gRvEHJaE84FBxtDoc6Gt+uzAekqIfQnmCvIyLAXKW2y30eV1rI4i7ypaETRPmMyVbW6z3TbzY5z7FCHu4VPy/1LjjBwwZFzygVxS+8axjg/1wwRi1XtzcBgrAA/FtA8LktfapPxQQji5saOXHOv1tXaz8nZO3JPC4fLq09HFN0AQ5lYLcRGeGNx5oe+g8aigDrpDhUqGlSW439eq0Oyw/u0LQHmI3b2X8glb9GajHKBFJS5F3xBXSf0TbPi9DSnQZMBlLi89K/DwuaPrU68w+ywSFyAoyQG50IJjEsOnY1Hv8ltfD5+PR23zfVIUgA3DkuIPKZohXzR89XoDKJVDegKRyYpFs036xFxvrpg/Xz5T73gpuPw3HgPDhRLxo/n8Kl3E=
  strategy: git
  app: davidrunger
